FROM quay.io/astronomer/astro-runtime:9.0.0

RUN pip install 'feast[snowflake,postgres,redis]'==0.33.1 
#typeguard dask cloudpickle

RUN python -m venv dbt_venv && source dbt_venv/bin/activate && \
pip3 install --no-cache-dir dbt-snowflake && deactivate

# ARG SNOWFLAKE_DEPLOYMENT_URL
# ARG SNOWFLAKE_SCHEMA
# ARG SNOWFLAKE_USER
# ARG SNOWFLAKE_ROLE
# ARG SNOWFLAKE_WAREHOUSE
# ARG SNOWFLAKE_DATABASE

# ENV AIRFLOW_VAR_SNOWFLAKE_DEPLOYMENT_URL=${SNOWFLAKE_DEPLOYMENT_URL}
# ENV AIRFLOW_VAR_SNOWFLAKE_SCHEMA=${SNOWFLAKE_SCHEMA}
# ENV AIRFLOW_VAR_SNOWFLAKE_USER=${SNOWFLAKE_USER}
# ENV AIRFLOW_VAR_SNOWFLAKE_PASSWORD=${SNOWFLAKE_PASSWORD}
# ENV AIRFLOW_VAR_SNOWFLAKE_ROLE=${SNOWFLAKE_ROLE}
# ENV AIRFLOW_VAR_SNOWFLAKE_WAREHOUSE=${SNOWFLAKE_WAREHOUSE}
# ENV AIRFLOW_VAR_SNOWFLAKE_DATABASE=${SNOWFLAKE_DATABASE}